<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>File Management</title>
<script type="text/javascript" src="simpletreemenu.js">
	
</script>

<link rel="stylesheet" type="text/css" href="simpletree.css" />
</head>
<body onload="readTextFile('filegoogle.json');">
	<div id="content">
		<ul id="treemenu" class="treeview">
		</ul>
	</div>
	<script type="text/javascript">
		function readTextFile(file) {
			var rawFile = new XMLHttpRequest();
			rawFile.open("GET", file, false);
			rawFile.onreadystatechange = function() {
				if (rawFile.readyState === 4) {
					if (rawFile.status === 200 || rawFile.status == 0) {
						var allText = rawFile.responseText;
						readJSON(allText);
					}
				}
			}
			rawFile.send(null);
		}
		
		function readJSON(data) {
			var json = JSON.parse(data);
			var listitem = json.items;
			var content='';
			
			var index = 0;
			var len=listitem.length;
			for (index = 0; index < len; ++index) {
				if (listitem[index].parents[0] != null ){
					if (listitem[index].parents[0].isRoot){
						if (listitem[index].mimeType == "application/vnd.google-apps.folder"){
							content = content + '<li>' + listitem[index].title + '<ul>' + getChildrens(listitem[index].id,listitem) + '</ul>' + '</li>';
						}
						else {
							content = content + '<li>' + listitem[index].title + '</li>';					
						}
					}
				}
			}
			document.getElementById("treemenu").innerHTML = content;
			ddtreemenu.createTree("treemenu", false);
		}
		
		function getChildrens(id,listitem){
			var content = "";
			var len=listitem.length;
			for (index = 0; index < len; ++index) {
				if (listitem[index].parents[0] != null ){
					if (listitem[index].parents[0].id == id){
						if (listitem[index].mimeType == "application/vnd.google-apps.folder"){
							content = content + '<li>' + listitem[index].title + '<ul>' + getChildrens(listitem[index].id,listitem) + '</ul>' + '</li>';
						}
						else {
							content = content + '<li>' + listitem[index].title + '</li>';					
						}
					}					
				}
			}
			return content;
		}
		
		
	</script>
</body>

</html>